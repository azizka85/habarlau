import{a as g,c as L,e as f}from"./chunk-PM37KJF3.js";import{a as E,b as x,c as d,g as y,h as m}from"./chunk-33W33KZV.js";var U=E(R=>{var b=class{routes=[];root="/";before;page404;constructor(t){t?.root&&(this.root=t.root==="/"?"/":"/"+this.trimSlashes(t.root)+"/"),typeof t?.before=="function"&&(this.before=t.before),typeof t?.page404=="function"&&(this.page404=t.page404),t?.routes?.length>0&&t.routes.forEach(e=>{this.add(e.rule,e.handler,e.options)})}get fragment(){let t=decodeURI(location.pathname);return this.root!=="/"&&(t=t.replace(this.root,"")),this.trimSlashes(t)}get query(){return this.parseQuery(location.search)}add(t,e,o){return this.routes.push({rule:this.parseRouteRule(t),handler:e,options:o}),this}remove(t){return typeof t=="string"&&(t=this.parseRouteRule(t)),this.routes.some((e,o)=>e.handler===t||e.rule===t?(this.routes.splice(o,1),!0):!1),this}async redirectTo(t,e){let o=this.transformURL(t);return history.replaceState(e,null,this.root+o),await this.processUri(),this}async navigateTo(t,e){let o=this.transformURL(t);return history.pushState(e,null,this.root+o),await this.processUri(),this}refresh(){return this.redirectTo(this.fragment+location.search,history.state)}transformURL(t){if(typeof t!="string")return"";let o=t.trim().split("?"),r="",n="";return o.length===1?r=o[0]:(r=o[0].trim(),n=o[1].trim()),r?(this.root!=="/"&&(r=r.replace(this.root,"")),r=this.trimSlashes(r)):r=this.fragment,n?`${r}?${n}`:r}trimSlashes(t){return typeof t!="string"?"":t.replace(/\/$/,"").replace(/^\//,"")}parseRouteRule(t){if(typeof t!="string")return t;let o=this.trimSlashes(t).replace(/([\\\/\-\_\.])/g,"\\$1").replace(/\{[a-zA-Z]+\}/g,"(:any)").replace(/\:any/g,"[\\w\\-\\_\\.]+").replace(/\:word/g,"[a-zA-Z]+").replace(/\:num/g,"\\d+");return new RegExp("^"+o+"$","i")}parseQuery(t){let e={};return typeof t!="string"||(t[0]==="?"&&(t=t.substr(1)),t.split("&").forEach(o=>{let r=o.split("=");r[0]!==""&&(r[1]===void 0&&(r[1]=!0),e[decodeURIComponent(r[0])]=r[1])})),e}async findRoute(){let t=this.fragment,e=this.query,o=!1;if(!this.before?.({fragment:t,query:e}))for(let n of this.routes){let p=t.match(n.rule);if(p){p.shift();let i={fragment:t,query:e,match:p,options:n.options};await n.handler?.(i),o=!0;break}}return o}async processUri(){let t=this.fragment;await this.findRoute()||this.page404?.(t)}addUriListener(){window.onpopstate=this.processUri.bind(this)}removeUriListener(){window.onpopstate=null}};R.Router=b});var v=x(U());var l=class{node=null;static get instance(){return l.page||(l.page=new l),l.page}get elem(){return this.node}async init(t,e){let o=t||document.body;return this.node=o.querySelector('[data-page="loader-page"]'),o}async mount(){await y(this.node)}async unmount(){await m(this.node)}},s=l;d(s,"page",null);var c=class extends L{static get instance(){return c.layout||(c.layout=new c),c.layout}},u=c;d(u,"layout",null);function P(){document.querySelector(".splash")?.classList.remove("splash--open")}function S(a){let t=u.instance;return a.length>0&&window.layouts[a[0]]&&(t=window.layouts[a[0]]),t}function T(a){let t=u.instance;for(let e of a)if(window.layouts[e]){t=window.layouts[e];break}return t}async function $(a,t,e){let o={};for(let r of a)if(!(r in window.layouts)){let n=await import(`./views/layouts/${r}.js?time=${Date.now()}`);t=await n[f(r)]?.instance?.init?.(t,e),window.layouts[r]=n[f(r)]?.instance,o[r]=!0}return o}async function k(a,t,e){let o=[...t].reverse(),r=u.instance;for(let n of o)r.content!==window.layouts[n]&&await r.replaceContent(window.layouts[n]),await window.layouts[n].load?.(a,e[n]??!1),r=window.layouts[n]}async function w(a,t,e,o){window.page=a;let r=null,n=!1;if(!(t in window.pages)){if(!o){let h=T(e);h.content!==s.instance&&await h.replaceContent(s.instance)}let i=await import(`./views/pages/${t}.js?time=${Date.now()}`);r=await i[f(t)]?.instance?.init?.(r,o),window.pages[t]=i[f(t)]?.instance,n=!0}let p=await $(e,r,o);if(window.page.fragment===a.fragment){await k(a,e,p);let i=S(e);i.content!==window.pages[t]&&await i.replaceContent(window.pages[t]),await window.pages[t].load?.(a,n)}o&&P()}window.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{let a=!0;s.instance.init(null,a);let t=new v.Router({root:g,routes:[{rule:"",async handler(e){await w(e,"home-page",["main-layout"],a)},options:{}},{rule:"/sign-in",async handler(e){await w(e,"sign-in-page",[],a)},options:{}},{rule:"/sign-up",async handler(e){await w(e,"sign-up-page",[],a)},options:{}}]});window.pages={},window.layouts={},window.router=t,t.addUriListener(),t.processUri().catch(e=>console.error(e)).finally(()=>a=!1)},500)});
